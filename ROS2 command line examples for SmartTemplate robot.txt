ROS2 command line for SmartTemplate (3DOF)

TO BUILD SYSTEM PACKAGES:
colcon build --cmake-args -DOpenIGTLink_DIR:PATH=/home/snr/OpenIGTLink-build

TO USE DEBUG MODE:
--ros-args --log-level debug
_______________________________________________________________________________________
1) Launch robot in manual mode

ros2 launch trajcontrol manual_smart.launch.py motion_step:=1.0 sim_level:=2
ros2 run smart_template keypress

OBS: 
motion_step argument is optional (default = 1.0 mm)
sim_level argument is optional (default = 2): 1=virtual / 2=real
Use numkeyboard arrows to move robot in horizontal and vertical directions. 
Use ENTER for needle insertion and SPACE for needle retraction.
_______________________________________________________________________________________
2) Launch OpenIGTLink demo (manual control)

***3DSlicer***
Open Slicer (using version 5.3)
Open SmartNeedle module (IGT)


***ROS2 computer***

ros2 launch trajcontrol openigtlink_demo_smart.launch.py
ros2 run smart_template keypress

OBS: 
Use numkeyboard arrows to move robot in horizontal and vertical directions. 
Use ENTER for needle insertion and SPACE for needle retraction.
_______________________________________________________________________________________
3) Launch Smart Needle experiment (manual control)

***ROS2 computer***

*Launch SmartNeedle packages
ros2 launch trajcontrol jhu_needle.launch.py 
ros2 run hyperion_interrogator calibrate_sensors --ros-args -r __ns:=/needle

*Launch igtl_bridge server to 3DSlicer
ros2 launch ros2_igtl_bridge bridge.launch.py
<CONFIGURE 3DSLICER NOW - see bellow>

*Launch SmartTemplate packages
ros2 launch smart_template robot.launch.py sim_level:=1 
ros2 run smart_template keypress
ros2 launch trajcontrol smartneedle_experiment.launch.py use_slicer:=True

OBS: 
- use_slicer argument is optional (default=False)
- insertion_length argument is optional when use_slicer is False (default=10.0). 
    When use_slicer=True, insertion_length is set by target
- Use numkeyboard arrows to move robot in horizontal and vertical directions. 
- Use ENTER for needle insertion and SPACE for needle retraction.

***3DSlicer***
Open Slicer (using version 5.3)
Step 1: ZFrameRegistrationROI module (IGT) 
    *Get zFrame registration
Step 2: Open SmartNeedle module (IGT)
    *Set zFrameTransform
    *Set IP and Port and start client
    *Select ENTRY and TARGET points
    <WAIT>

_______________________________________________________________________________________


EXTRAS:

A) Record bag files:
ros2 bag record -a -o BAG_NAME

B) Check interrogator topics:
ros2 topic list
ros2 topic echo topic_name
ros2 topic hz topic_name

C) Kill zoombie nodes (Example with igtl_bridge server)
ps -aux | grep igtl_bridge
kill -9 NUMBER

ros2 service call /command smart_control_interfaces/srv/ControllerCommand "command: RETRACT"

ros2 action send_goal /move_stage smart_control_interfaces/action/MoveStage "{x: 10, z: 0, eps: 0.0001}"
